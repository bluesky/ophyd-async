record(ao, "PANDAQSRVE:PULSE1:DELAY")
{
    field(EGU,  "us")
    # Add to PULSE1:PVI PVA structure
    info(Q:group, {
        "PANDAQSRVE:PULSE1:PVI": {
            "pvi.delay.rw": {
                "+channel": "NAME",
                "+type": "plain"
            }
        }
    })
}

record(ao, "PANDAQSRVE:PULSE1:WIDTH")
{
    field(EGU,  "us")
    info(Q:group, {
        # Add to PULSE1:PVI PVA structure
        "PANDAQSRVE:PULSE1:PVI": {
            "pvi.width.rw": {
                "+channel": "NAME",
                "+type": "plain"
            }
        }
    })
}

record(waveform, "BOOL:PLEASE")
{
    field(NELM, 10)
    field(FTVL, "ENUM")
    field(INP, [0, 0, 1, 1, 0, 1, 1, 0])
    info(Q:form, "Binary")
}

# We want to add PANDAQSRVE:PULSE1 to PANDAQSRVE:PVI
# structure, but we can't create a record called
# PANDAQSRVE:PVI as it will shadow the QSRV created structure.
# We make a different PV and use its input link to hack around this
record(stringin, "PANDAQSRVE:PULSE1:_PVI")
{
    field(VAL,  "PANDAQSRVE:PULSE1:PVI")
    info(Q:group, {
        "PANDAQSRVE:PVI": {
            "pvi.pulse1.d": {
                "+channel": "VAL",
                "+type": "plain"
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:LABELS") {
    field(FTVL, "STRING")
    field(NELM, "64")
    field(INP , {const:["Repeats", "Trigger", "Position", "Time1", "OutA1", "OutB1", "OutC1", "OutD1", "OutE1", "OutF1", "Time2", "OutA2", "OutB2", "OutC2", "OutD2", "OutE2", "OutF2"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "+id": "epics:nt/NTTable:1.0",
            "labels": {
                "+type": "plain",
                "+channel": "VAL"
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:REPEATS")
{
    field(FTVL, "USHORT")
    field(NELM, "4096")
    field(INP, {const:[1, 1, 1, 32]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.repeats": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":0
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:TRIGGER")
{
    field(FTVL, "STRING")
    field(NELM, "4096")
    field(INP, {const:["POSA>=POSITION", "POSA<=POSITION", "Immediate", "Immediate"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.trigger": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":1
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:POSITION")
{
    field(FTVL, "LONG")
    field(NELM, "4096")
    field(INP, {const:["3222", "-565", "0", "0"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.position": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":2
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:TIME1")
{
    field(FTVL, "ULONG")
    field(NELM, "4096")
    field(INP, {const:["5", "0", "10", "10"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.time1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":3
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTA1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, false, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outa1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":4
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTB1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[false, false, true, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outb1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":5
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTC1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[false, true, true, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outc1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":6
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTD1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, true, false, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outd1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":7
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTE1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, true, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.oute1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":8
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTF1")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, false, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outf1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":9
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:TIME2")
{
    field(FTVL, "ULONG")
    field(NELM, "4096")
    field(INP, {const:["0", "10", "10", "11"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.time2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":10
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTA2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, false, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outa2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":11
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTB2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[false, false, true, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outb2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":12
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTC2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[false, true, true, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outc2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":13
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTD2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, true, false, true]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outd2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":14
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTE2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, true, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.oute2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":15
            }
        }
    })
}

# Last column has metadata
record(waveform, "PANDAQSRVE:SEQ1:TABLE:OUTF2")
{
    field(FTVL, "UCHAR")
    field(NELM, "4096")
    field(INP, {const:[true, false, false, false]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:TABLE": {
            "value.outf2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":16
            },
            "": {"+type": "meta", "+channel": "VAL"},
        }
    })
}

# Again, SEQ1:TABLE is QSRV only, so need to make a fake PV to put it in 
# SEQ1:PVI
record(stringin, "PANDAQSRVE:SEQ1:TABLE:_PVI")
{
    field(VAL,  "PANDAQSRVE:SEQ1:TABLE")
    info(Q:group, {
        "PANDAQSRVE:SEQ1:PVI": {
            "pvi.table.rw": {
                "+channel": "VAL",
                "+type": "plain",
                "+putorder":17
            }
        }
    })
}


record(stringin, "PANDAQSRVE:SEQ1:_PVI")
{
    field(VAL,  "PANDAQSRVE:SEQ1:PVI")
    info(Q:group, {
        "PANDAQSRVE:PVI": {
            "pvi.seq1.d": {
                "+channel": "VAL",
                "+type": "plain",
                "+putorder":18
            }
        }
    })
}



record(waveform, "PANDAQSRVE:SEQ1:STRTABLE:LABELS") {
    field(FTVL, "STRING")
    field(NELM, "64")
    field(INP , {const:["Col1", "Col2"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:STRTABLE": {
            "+id": "epics:nt/NTTable:1.0",
            "labels": {
                "+type": "plain",
                "+channel": "VAL"
            }
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:STRTABLE:COL1")
{
    field(FTVL, "STRING")
    field(NELM, "64")
    field(INP, {const:["Foo", "Bar"]})
    info(Q:group, {
        "PANDAQSRVE:SEQ1:STRTABLE": {
            "value.col1": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":1
            },
        }
    })
}

record(waveform, "PANDAQSRVE:SEQ1:STRTABLE:COL2")
{
    field(FTVL, "STRING")
    field(NELM, "64")
    field(INP, {const:["Bat", "Baz"]})
    field(PINI, "YES")
    info(Q:group, {
        "PANDAQSRVE:SEQ1:STRTABLE": {
            "value.col2": {
                "+type": "plain",
                "+channel": "VAL",
                "+putorder":2
            },
            "": {"+type": "meta", "+channel": "VAL"},
        }
    })
}


record(ao, "PANDAQSRVE:PCAP:ARM")
{
    info(Q:group, {
        "PANDAQSRVE:PCAP:PVI": {
            "pvi.arm.x": {
                "+channel": "NAME",
                "+type": "plain"
            }
        }
    })
}


record(stringin, "PANDAQSRVE:PCAP:_PVI")
{
    field(VAL,  "PANDAQSRVE:PCAP:PVI")
    info(Q:group, {
        "PANDAQSRVE:PVI": {
            "pvi.pcap.d": {
                "+channel": "VAL",
                "+type": "plain"
            }
        }
    })
}


record(ao, "PANDAQSRVE:EXTRA:ARM")
{
    info(Q:group, {
        "PANDAQSRVE:EXTRA:PVI": {
            "pvi.arm.x": {
                "+channel": "NAME",
                "+type": "plain"
            }
        }
    })
}


record(stringin, "PANDAQSRVE:EXTRA:_PVI")
{
    field(VAL,  "PANDAQSRVE:EXTRA:PVI")
    info(Q:group, {
        "PANDAQSRVE:PVI": {
            "pvi.extra.d": {
                "+channel": "VAL",
                "+type": "plain"
            }
        }
    })
}
